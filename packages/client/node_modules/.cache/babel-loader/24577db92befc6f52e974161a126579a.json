{"ast":null,"code":"var _jsxFileName = \"/root/Projects/bill-aggregator/packages/client/src/providers/auth/index.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport loadScript from 'load-script';\nimport { useNavigate } from 'react-router-dom';\nimport { routes } from '../../router/routes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext({});\nexport const AuthProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [isSignedIn, setIsSignedIn] = useState(false);\n  const [gapiLoaded, setGapiLoaded] = useState(false);\n  const navigate = useNavigate();\n\n  const handleCredentialResponse = data => {\n    if (data !== null && data !== void 0 && data.credential) {\n      setIsSignedIn(true);\n      sessionStorage.setItem('aggregator_token', data === null || data === void 0 ? void 0 : data.credential);\n      navigate(routes.main);\n    }\n  };\n\n  useEffect(() => {\n    loadScript('https://accounts.google.com/gsi/client', () => {\n      const {\n        google\n      } = window;\n\n      if (google) {\n        var _google$accounts, _google$accounts$id;\n\n        google === null || google === void 0 ? void 0 : (_google$accounts = google.accounts) === null || _google$accounts === void 0 ? void 0 : (_google$accounts$id = _google$accounts.id) === null || _google$accounts$id === void 0 ? void 0 : _google$accounts$id.initialize({\n          client_id: process.env.REACT_APP_GMAIL_CLIENT_ID,\n          callback: handleCredentialResponse\n        });\n        setGapiLoaded(true);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    setIsSignedIn();\n  }, [gapiLoaded]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      isSignedIn,\n      setIsSignedIn,\n      gapiLoaded\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthProvider, \"lV0bJQvyg7lBRo+cc0W9GCP1MIk=\", false, function () {\n  return [useNavigate];\n});\n\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n\n  const authContext = useContext(AuthContext);\n  return { ...authContext\n  };\n};\n\n_s2(useAuth, \"g0q6N3HTsGa67OokMUhTOzE2a0M=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/root/Projects/bill-aggregator/packages/client/src/providers/auth/index.js"],"names":["createContext","useContext","useEffect","useState","loadScript","useNavigate","routes","AuthContext","AuthProvider","children","isSignedIn","setIsSignedIn","gapiLoaded","setGapiLoaded","navigate","handleCredentialResponse","data","credential","sessionStorage","setItem","main","google","window","accounts","id","initialize","client_id","process","env","REACT_APP_GMAIL_CLIENT_ID","callback","useAuth","authContext"],"mappings":";;;;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,QAA/C,QAA+D,OAA/D;AACA,OAAOC,UAAP,MAAuB,aAAvB;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,MAAT,QAAuB,qBAAvB;;AAEA,MAAMC,WAAW,gBAAGP,aAAa,CAAC,EAAD,CAAjC;AAEA,OAAO,MAAMQ,YAAY,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AAC5C,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BR,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAM,CAACS,UAAD,EAAaC,aAAb,IAA8BV,QAAQ,CAAC,KAAD,CAA5C;AACA,QAAMW,QAAQ,GAAGT,WAAW,EAA5B;;AAEA,QAAMU,wBAAwB,GAAIC,IAAD,IAAU;AACzC,QAAIA,IAAJ,aAAIA,IAAJ,eAAIA,IAAI,CAAEC,UAAV,EAAsB;AACpBN,MAAAA,aAAa,CAAC,IAAD,CAAb;AACAO,MAAAA,cAAc,CAACC,OAAf,CAAuB,kBAAvB,EAA2CH,IAA3C,aAA2CA,IAA3C,uBAA2CA,IAAI,CAAEC,UAAjD;AACAH,MAAAA,QAAQ,CAACR,MAAM,CAACc,IAAR,CAAR;AACD;AACF,GAND;;AAQAlB,EAAAA,SAAS,CAAC,MAAM;AACdE,IAAAA,UAAU,CAAC,wCAAD,EAA2C,MAAM;AACzD,YAAM;AAAEiB,QAAAA;AAAF,UAAaC,MAAnB;;AAEA,UAAID,MAAJ,EAAY;AAAA;;AACVA,QAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,gCAAAA,MAAM,CAAEE,QAAR,6FAAkBC,EAAlB,4EAAsBC,UAAtB,CAAiC;AAC/BC,UAAAA,SAAS,EAAEC,OAAO,CAACC,GAAR,CAAYC,yBADQ;AAE/BC,UAAAA,QAAQ,EAAEf;AAFqB,SAAjC;AAKAF,QAAAA,aAAa,CAAC,IAAD,CAAb;AACD;AACF,KAXS,CAAV;AAYD,GAbQ,EAaN,EAbM,CAAT;AAeAX,EAAAA,SAAS,CAAC,MAAM;AACdS,IAAAA,aAAa;AACd,GAFQ,EAEN,CAACC,UAAD,CAFM,CAAT;AAIA,sBACE,QAAC,WAAD,CAAa,QAAb;AACE,IAAA,KAAK,EAAE;AACLF,MAAAA,UADK;AAELC,MAAAA,aAFK;AAGLC,MAAAA;AAHK,KADT;AAAA,cAOGH;AAPH;AAAA;AAAA;AAAA;AAAA,UADF;AAWD,CA3CM;;GAAMD,Y;UAGMH,W;;;KAHNG,Y;AA6Cb,OAAO,MAAMuB,OAAO,GAAG,MAAM;AAAA;;AAC3B,QAAMC,WAAW,GAAG/B,UAAU,CAACM,WAAD,CAA9B;AAEA,SAAO,EACL,GAAGyB;AADE,GAAP;AAGD,CANM;;IAAMD,O","sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\nimport loadScript from 'load-script';\nimport { useNavigate } from 'react-router-dom';\nimport { routes } from '../../router/routes';\n\nconst AuthContext = createContext({});\n\nexport const AuthProvider = ({ children }) => {\n  const [isSignedIn, setIsSignedIn] = useState(false);\n  const [gapiLoaded, setGapiLoaded] = useState(false);\n  const navigate = useNavigate();\n\n  const handleCredentialResponse = (data) => {\n    if (data?.credential) {\n      setIsSignedIn(true);\n      sessionStorage.setItem('aggregator_token', data?.credential);\n      navigate(routes.main);\n    }\n  };\n\n  useEffect(() => {\n    loadScript('https://accounts.google.com/gsi/client', () => {\n      const { google } = window;\n\n      if (google) {\n        google?.accounts?.id?.initialize({\n          client_id: process.env.REACT_APP_GMAIL_CLIENT_ID,\n          callback: handleCredentialResponse,\n        });\n\n        setGapiLoaded(true);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    setIsSignedIn();\n  }, [gapiLoaded]);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        isSignedIn,\n        setIsSignedIn,\n        gapiLoaded,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const authContext = useContext(AuthContext);\n\n  return {\n    ...authContext,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}